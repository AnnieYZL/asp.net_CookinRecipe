@using CookinRecipe.BusinessLayers
@using CookinRecipe.DomainModels
@model List<Recipe>
@{
    ViewData["Title"] = "Trang chủ";
    var me = User.GetUserData();
    Layout = null;
}
<!doctype html>
<html>
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Cookin Recipe - @ViewBag.title</title>

    <!-- Favicon -->
    <link rel="shortcut icon" href="~/Themes/assets/images/vLOGO.png" type="image/x-icon" />

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Cabin:wght@400;500;600;700&family=Roboto:wght@100;300;400;500;700;900&display=swap" rel="stylesheet">

    <!-- CSS Libraries -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" rel="stylesheet" />
    <link href="https://unpkg.com/tailwindcss@2.0.0/dist/tailwind.min.css" rel="stylesheet">
    <link href="/css/animate.css" rel="stylesheet" />
    <link href="~/Themes/styles/main.css" rel="stylesheet" type="text/css">
    <link rel="stylesheet" type="text/css" href="~/lib/DataTables/Buttons-2.0.1/buttons.dataTables.min.css">

    <!-- jQuery & Plugins -->
    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/lib/jquery_ui/jquery-ui-1.13.2/jquery-ui.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>

    <!-- Notify -->
    <script src="/lib/notify/bootstrap-notify.min.js"></script>

    <!-- DataTables -->
    <script src="~/lib/DataTables/jquery.dataTables.min.js" asp-append-version="true"></script>
    <script src="~/lib/DataTables/checkboxes.min.js" asp-append-version="true"></script>
    <script src="~/lib/datatables/datatables.rowgroup.min.js"></script>
    <script src="~/lib/datatables/datatables.rowsgroup.js"></script>
    <script src="~/lib/DataTables/Buttons-2.0.1/dataTables.buttons.min.js"></script>
    <script src="~/lib/DataTables/JSZip-2.5.0/jszip.min.js"></script>
    <script src="~/lib/DataTables/Buttons-2.0.1/buttons.html5.min.js"></script>

    <!-- Custom CSS -->
    <style>
        .scrollbar-hidden::-webkit-scrollbar {
            width: 0;
            height: 0;
        }

        .card {
            box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2);
            max-width: 255px;
            margin: auto;
            text-align: center;
            font-family: arial;
            background-color: white;
        }

        .title {
            color: grey;
            font-size: 18px;
        }

        button#searchBtn {
            border: none;
            outline: 0;
            display: inline-block;
            padding: 8px;
            color: white;
            background-image: linear-gradient(to right, #2a60eb, #763cec);
            text-align: center;
            cursor: pointer;
            /* width: 100%; */
            font-size: 18px;
        }

        a {
            text-decoration: none;
            font-size: 22px;
            color: black;
        }

        .hover-container:hover .hover-image {
            transform: scale(1.2);
        }

        .hover-container:hover .hover-info {
            opacity: 1;
        }

        .decor-line {
            position: absolute;
            background-color: #c28b36;
            transition: width 0.5s ease-in-out, height 0.5s ease-in-out, opacity 0.5s ease-in-out;
            opacity: 0;
        }

        .hover-container:hover .line-horizontal {
            width: 55%;
            opacity: 1;
        }

        .hover-container:hover .line-vertical {
            height: 55%;
            opacity: 1;
        }

        .line-horizontal {
            width: 3px;
            height: 3px;
            bottom: 40px;
            left: 30px;
        }

        .line-vertical {
            width: 3px;
            height: 20px;
            bottom: 30px;
            left: 40px;
        }

        .text-slide {
            position: relative;
            opacity: 0;
            transition: opacity 0.5s ease-in-out, transform 0.5s ease-in-out;
        }

        .hover-container:hover .text-left {
            opacity: 1;
            transform: translateX(0);
        }

        .hover-container:hover .text-right {
            opacity: 1;
            transform: translateX(0);
        }

        .text-left {
            transform: translateX(-50px);
        }

        .text-right {
            transform: translateX(50px);
        }
    </style>
</head>
<body>
    <header class="fixed top-0 w-full z-50 bg-white shadow">
        <nav class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">

                <a href="~/Home/Index" class="flex items-center space-x-2">
                    <h2 class="text-blue-600 font-bold text-2xl">CookinRecipe</h2>
                </a>

                <div class="hidden md:flex items-center space-x-6">
                    <a href="@Url.Action("Index", "Recipe")" class="text-blue-600 font-medium hover:text-blue-800">Công thức</a>
                    <a href="@Url.Action("Index", "Course")" class="text-blue-600 font-medium hover:text-blue-800">Thực đơn</a>
                    <a href="@Url.Action("Index", "Ingredient")" class="text-blue-600 font-medium hover:text-blue-800">Nguyên liệu</a>
                    @if (me != null && (me.Roles.Contains("admin") || me.Roles.Contains("moderator")))
                    {
                        <a href="@Url.Action("Index", "Management")" class="text-blue-600 font-medium hover:text-blue-800">Quản lý</a>
                    }
                </div>

                <!-- User Actions -->
                <div class="flex items-center space-x-4">
                    @{
                        if (me != null)
                        {
                            <!-- Notifications -->
                            <div class="relative">
                                <button id="messageButton" data-userid="@me.UserId" class="text-blue-600 hover:text-blue-700">
                                    <i class="fas fa-bell text-xl"></i>
                                    <span id="notificationCount"
                                          class="absolute -top-1 -right-1 bg-red-500 text-white text-xs font-bold px-1.5 py-0.5 rounded-full hidden">
                                        0
                                    </span>
                                </button>
                                <div id="messageDropdown"
                                     class="hidden absolute right-0 mt-2 w-64 max-h-60 bg-white shadow-lg rounded-lg overflow-y-auto z-50"
                                     style="overflow-x: hidden;">
                                    <div id="noti-loading" class="p-3 text-center text-gray-500">đang tải thông báo...</div>
                                </div>
                            </div>

                            <!-- Avatar Dropdown -->
                            <div class="relative">
                                <button id="avaButton">
                                    <img src="~/FileUpload/images/user/@me.UserImage" class="w-8 h-8 rounded-full" alt="Avatar" />
                                </button>
                                <div id="avaDropdown"
                                     class="hidden absolute right-0 mt-2 w-52 bg-white shadow-lg rounded-lg overflow-hidden z-50">
                                    <!-- Nội dung dropdown -->
                                    <div class="flex items-center p-3 border-b">
                                        <img src="~/FileUpload/images/user/@me.UserImage" class="w-12 h-12 rounded-full" />
                                        <div class="ml-3">
                                            <p class="text-gray-800 font-bold truncate">@me.FullName</p>
                                            <a href="~/User/Index" class="text-blue-600 text-sm font-sans">Xem trang cá nhân</a>
                                        </div>
                                    </div>
                                    <div class="p-2 divide-y text-gray-700">
                                        <a href="~/Recipe/Create" class="flex items-center p-2 hover:bg-gray-100 font-sans">
                                            <i class="fas fa-pen mr-2"></i> Tạo công thức mới
                                        </a>
                                        <a href="~/Favourite/Index" class="flex items-center p-2 hover:bg-gray-100 font-sans">
                                            <i class="fas fa-thumbs-up mr-2"></i> Đã thích
                                        </a>
                                        <a href="~/List/Index" class="flex items-center p-2 hover:bg-gray-100 font-sans">
                                            <i class="fas fa-bookmark mr-2"></i> Danh sách lưu
                                        </a>
                                        <a href="~/Account/ChangePassword" class="flex items-center p-2 hover:bg-gray-100 font-sans">
                                            <i class="fas fa-key mr-2"></i> Đổi mật khẩu
                                        </a>
                                        <a href="~/Account/Logout" class="flex items-center p-2 hover:bg-gray-100 font-semibold text-red-600 font-sans">
                                            <i class="fas fa-sign-out-alt mr-2"></i> Đăng xuất
                                        </a>
                                    </div>
                                </div>
                            </div>
                        }
                        else
                        {
                            <a href="~/Account/Login" class="text-blue-600 hover:text-blue-800 font-medium">Đăng nhập</a>

                            <button class="bg-gradient-to-r from-blue-600 to-purple-600 hover:bg-blue-700 duration-300 text-white text-base font-regular py-2 px-4 rounded">
                                <a id="nav-signup-btn" href="~/Account/SignUp" class="md:flex hidden text-white">
                                    Đăng ký
                                </a>
                            </button>

                        }
                    }

                    <div class="md:hidden">
                        <button class="mobile-menu-button">
                            <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" stroke-width="2"
                                 stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24">
                                <path d="M4 6h16M4 12h16M4 18h16" />
                            </svg>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Mobile Menu -->
            <div class="hidden mobile-menu md:hidden mt-2 space-y-2 px-4 pb-4 border-t pt-4">
                @if (me == null)
                {
                    <a href="~/Account/Login" class="font-sans block text-center text-blue-600">Đăng nhập</a>
                    <a href="~/Account/SignUp" class="font-sans text-center block text-blue-600">Đăng ký</a>
                }
                <a href="~/Recipe/Index" class="font-sans text-center block">Công thức</a>
                <a href="~/Course/Index" class="font-sans text-center block">Thực đơn</a>
                <a href="~/Ingredient/Index" class="font-sans text-center block">Nguyên liệu</a>
                @if (me != null && me.Roles.Contains("admin"))
                {
                    <a href="~/Management/Index" class="font-sans text-center block">Quản lý</a>
                }
            </div>
        </nav>

        <script>
            document.getElementById("avaButton")?.addEventListener("click", () => {
                document.getElementById("avaDropdown")?.classList.toggle("hidden");
            });


            document.addEventListener("click", (e) => {
                const avatar = document.getElementById("avaButton");
                const dropdown = document.getElementById("avaDropdown");
                if (!avatar.contains(e.target) && !dropdown.contains(e.target)) {
                    dropdown.classList.add("hidden");
                }

            });

            document.querySelector(".mobile-menu-button")?.addEventListener("click", () => {
                document.querySelector(".mobile-menu")?.classList.toggle("hidden");
            });
            $(document).ready(function () {
                const dropdown = $('#messageDropdown');
                const loading = $('#noti-loading');
                const badge = $('#notificationCount');

                function loadNotifications() {
                    const userId = $('#messageButton').data('userid');
                    loading.text("Đang tải thông báo...");
                    dropdown.html(loading);

                    $.ajax({
                        url: '/Home/GetNotifications',
                        type: 'GET',
                        data: { userId: userId },
                        success: function (response) {
                            const data = response.items;
                            const unread = response.unread;
                            let html = `
                                        <div class="px-4 py-2 border-b mb-2 mx-2 font-semibold font-sans select-none">
                                            Thông Báo
                                        </div>
                                    `;
                            if (unread > 0) {
                                badge.text(unread).removeClass('hidden');
                            } else {
                                badge.addClass('hidden');
                            }

                            if (data.length === 0) {
                                dropdown.html('<div class="p-3 text-center text-gray-500 font-sans">Bạn chưa có thông báo nào.</div>');
                            } else {

                                data.forEach(item => {
                                    const link = item.recipeId ? `/Recipe/Detail/${item.recipeId}` : '#';
                                    let iconClass = 'fas fa-info-circle text-blue-500';
                                    switch (item.type) {
                                        case 'UndoVerified':
                                            iconClass = 'fas fa-undo text-red-500';
                                            break;
                                        case 'Favourite':
                                            iconClass = 'fas fa-heart text-pink-500';
                                            break;
                                        case 'Rate':
                                            iconClass = 'fas fa-star text-yellow-500';
                                            break;
                                        case 'Verified':
                                            iconClass = 'fas fa-check-circle text-green-500';
                                            break;
                                        case 'Reply':
                                            iconClass = 'fas fa-bullhorn text-yellow-500';
                                            break;
                                        case 'Comment':
                                            iconClass = 'fas fa-comment text-blue-500';
                                            break;
                                        case 'Permission':
                                            iconClass = 'fas fa-key text-yellow-500';
                                            break;
                                    }

                                    html += `
                                        <a href="${link}" class="notification-link block px-4 py-3 hover:bg-blue-50 transition-all duration-200 ${item.isRead ? '' : 'bg-gray-100'} mx-2" data-notifyid="${item.notificationId}">
                                            <div class="flex items-start font-sans space-x-2">
                                                <i class="${iconClass} mt-1 text-lg min-w-[20px] text-center"></i>
                                                <div class="flex-1">
                                                    <div class="font-semibold font-sans text-gray-800 break-words">${item.title || 'Không có tiêu đề'}</div>
                                                    <div class="text-sm text-gray-600 font-sans break-words">${item.message || ''}</div>
                                                    <div class="text-xs text-gray-400 font-sans mt-1">${item.createdAt}</div>
                                                </div>
                                            </div>
                                        </a>
                                        `;
                                });

                                dropdown.html(html);

                                $('.notification-link').on('click', function (e) {
                                    e.preventDefault();

                                    const notifyId = $(this).data('notifyid');
                                    const href = $(this).attr('href');
                                    console.log(notifyId);
                                    $.ajax({
                                        url: '/Home/MarkNotificationRead',
                                        type: 'POST',
                                        contentType: 'application/json',
                                        data: JSON.stringify({ id: notifyId }),
                                        success: function () {
                                            window.location.href = href;
                                        },
                                        error: function () {
                                            console.error('Không đánh dấu đã đọc được');
                                            window.location.href = href;
                                        }
                                    });
                                });

                            }
                        },
                        error: function () {
                            dropdown.html('<div class="p-3 text-center text-red-500">Lỗi khi tải thông báo.</div>');
                        }
                    });
                }


                $('#messageButton').on('click', function () {
                    dropdown.toggleClass('hidden');
                    if (!dropdown.hasClass('hidden')) {
                        loadNotifications();
                    }
                });

                $(document).on('click', function (e) {
                    if (!$(e.target).closest('#messageButton, #messageDropdown').length) {
                        dropdown.addClass('hidden');
                    }
                });

                loadNotifications();
            });

        </script>
    </header>
<!--Menu Section-->
<section class="relative bg-white min-h-screen">
    <div class="container p-10 mx-auto my-auto flex flex-col lg:flex-row items-center gap-12 md:mt-20 mt-12 h-fit">
        <!-- Image -->
        <div class="relative items-center mx-auto overflow-hidden group justify-center mb-10 md:mb-16 lg:mb-0 z-10 fadeInRotate">
            <img src="~/FileUpload/images/home/plate.png" alt="Ảnh trước" class="w-full object-cover relative z-10">
            <img id="fade-image" src="~/Themes/assets/images/hover.png" alt="Ảnh sau"
                 class="absolute top-0 left-0 w-full h-full bg-cover bg-center transition-all duration-500 opacity-0 transition-opacity duration-1000 ease-in-out">
            <script>
                window.addEventListener('DOMContentLoaded', () => {
                    setTimeout(() => {
                        document.getElementById('fade-image').classList.add('opacity-100');
                    }, 1800);
                });
            </script>
        </div>
        <!-- Content -->
        <div class="flex flex-1 md:ml-10 flex-col items-center lg:items-start overflow-hidden">
            <h2 class="bg-clip-text text-transparent bg-gradient-to-r from-blue-600 to-purple-600 text-center lg:text-left font-bold text-3xl md:text-4xl lg:text-5xl mb-2 py-2 fadeInLeft">
                Nấu nướng dễ dàng với CookinRecipe
            </h2>
            <p class="font-thin text-lg text-center lg:text-left text-gray-600 italic fadeInRight">
                Lấy cảm hứng từ sự phát triển, CookinRecipe là nơi giao lưu chia sẻ những công thức món ăn từ khắp
                mọi nơi. Bạn có thể tiết kiệm thời gian trong việc lựa chọn và chế biến món ăn, cũng như khám phá sự
                đa dạng trong ẩm thực.
            </p>
            <a href="#search-dish" class="text-white">
                <button type="button"
                        class="mt-6 bg-blue-600 text-white text-lg font-regular py-2 px-3 rounded transition duration-500 ease-in-out transform hover:bg-blue-700 cursor-pointer mx-auto slideUp">
                    Xem ngay
                </button>
            </a>
        </div>
    </div>
</section>

<!-- Newest recipe -->
<div class="w-full flex flex-1 flex-col justify-center bg-white p-6">
    <h1 class="text-xl font-regular mx-auto text-br">Bài viết mới nhất</h1>
    <h1 class="text-3xl font-regular mx-auto text-bl mb-3">Của người dùng CookinRecipe</h1>
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
        @foreach (var item in Model)
        {
            <div class="h-auto rounded overflow-hidden shadow-lg transition duration-500 ease-in-out transform hover:-translate-y-1 hover:scale-105 ...">
                <img src="~/FileUpload/images/recipe/@item.RecipeImage" class="w-full h-52 object-cover cursor-pointer"
                     alt="Hình ảnh món ăn">
                <div class='px-4 py-2'>
                    <div class="mb-2 font-medium text-xl overflow-ellipsis overflow-hidden whitespace-nowrap cursor-pointer"
                         id="01">
                        <a href="~/Recipe/Detail/@item.RecipeID">@item.RecipeName</a>
                    </div>

                    <p class='font-regular text-gray-600 text-base leading-normal h-12 overflow-ellipsis overflow-hidden w-full'>
                        @item.Description
                    </p>
                </div>
                <div class='px-3 pb-1 flex flex-row'>
                    @foreach (var i in RecipeDataService.GetMainIngredient(item.RecipeID))
                    {
                        <a href="~/Ingredient/Index?ingredientId=@i.IngredientID">
                            <span class="inline-block bg-gray-200 rounded-full px-2 py-1 text-sm font-medium text-gray-700 mr-2 mb-2">@i.IngredientName</span>
                        </a>
                    }
                    @foreach (var h in RecipeDataService.GetCoursesOf(item.RecipeID))
                    {
                        <a href="~/Course/Detail?courseId=@h.CourseID">
                            <span class="inline-block bg-gray-200 rounded-full px-2 py-1 text-sm font-medium text-gray-700 mr-2 mb-2">@h.CourseName</span>
                        </a>
                    }
                </div>

                <div class="px-4 pb-2 flex flex-row">
                    <p class='overflow-ellipsis overflow-hidden whitespace-nowrap font-regular text-gray-600 text-base leading-normal'>
                        <i class="fas fa-clock text-bl"></i> @item.PrepTime phút
                    </p>
                    @{
                        var isLiked1 = me != null && FavouriteDataService.CheckFav(long.Parse(me.UserId), item.RecipeID);
                        var iconClass1 = isLiked1 ? "fa-solid text-red-600" : "fa-regular text-gray-500";
                    }

                    <i id="dish-page-like-btn"
                       class="fa-heart @iconClass1 text-xl cursor-pointer ml-auto"
                       onclick="toggleLikeButton(this, @item.RecipeID)">
                    </i>
                    @if (me != null)
                    {
                        <button type="button" class="saveBtn ml-5 cursor-pointer" data-recipe-id="@item.RecipeID">
                            @if (RecipeDataService.CheckExistsInList(item.RecipeID, long.Parse(me.UserId)))
                            {
                                <i class="fa fa-bookmark text-blue-600"></i>
                            }
                            else
                            {
                                <i class="fa fa-bookmark text-gray-500"></i>
                            }
                        </button>
                    }
                    else
                    {
                        <button type="button" class="ml-5 cursor-pointer">
                            <i class="fa fa-bookmark text-gray-500"></i>
                        </button>
                    }
                </div>
            </div>
        }
    </div>

</div>

<!-- Modal Save -->
<div id="modalSave" class="fixed inset-0 bg-gray-800 bg-opacity-50 flex items-center justify-center hidden z-50">
    <div id="modalSaveContent"
         class="bg-white p-4 rounded-lg shadow-lg w-96 h-[500px] max-h-[80vh] overflow-hidden transition-all relative">
        <div class="flex justify-between items-center border-b pb-2 mb-2">
            <h2 class="text-xl text-blue-600 font-medium">Lưu vào</h2>
            <button id="closeModalSave" class="text-2xl font-bold text-black cursor-pointer" aria-label="Đóng modal">×</button>
        </div>
        @if (User.GetUserData() != null)
        {
            <div class="overflow-y-auto max-h-72 min-h-[50px]" tabindex="0">
                <ul id="listContainer" class="space-y-2">
                    @foreach (var item in ListDataService.GetListOf(long.Parse(User.GetUserData().UserId)))
                    {
                        <li class="p-2 bg-gray-100 rounded flex items-center space-x-3 cursor-pointer hover:bg-gray-200" data-list-id="@item.ListID" role="button" tabindex="0">
                                <img src="~/FileUpload/images/list/@item.ListImage" class="w-12 h-12 rounded-lg" alt="Danh sách 1">
                            <div>
                                <span class="font-medium">@item.ListName</span>
                                <p class="text-sm text-gray-500">@ListDataService.GetListQuantity(item.ListID) công thức</p>
                            </div>
                        </li>
                    }
                </ul>
            </div>
        }
        <button id="newListBtn"
                class="mt-4 w-full font-sans flex items-center justify-center gap-2 bg-gray-200 text-black py-2 rounded-lg hover:bg-gray-300 cursor-pointer">
            + Bộ sưu tập mới
        </button>
        <button id="doneBtn"
                class="mt-4 w-full font-sans bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700 cursor-pointer">
            Lưu
        </button>
    </div>
</div>

<!-- Category -->
<div id="search-dish" class="mt-20 w-full flex flex-1 flex-col justify-center bg-white p-5 mb-5">
    <h1 class="text-xl font-regular mx-auto text-br mt-15">Tìm kiếm</h1>
    <h1 class="text-3xl font-regular mx-auto text-bl mb-3">Công thức tại CookinRecipe</h1>
    <div class="bg-white p-3 mb-5">
        <!--Search bar-->
        <form id="formSearch" action="/Recipe/Index" method="get" data-container="#searchResult">
            <div class="border rounded overflow-hidden flex mb-4">
                <input id="home-dish-search-bar" name="SearchValue" type="text"
                       class="w-11/12 px-4 py-2 border-gray-300 focus:ring-blue-600 font-regular"
                       placeholder="Nhập tên món ăn bạn muốn nấu">
                <button type="submit" class="flex w-1/12 items-center justify-center bg-blue-600 md:px-4 border-l">
                    <svg class="h-4 w-4 text-white" fill="currentColor" xmlns="http://www.w3.org/2000/svg"
                         viewBox="0 0 24 24">
                        <path d="M16.32 14.9l5.39 5.4a1 1 0 0 1-1.42 1.4l-5.38-5.38a8 8 0 1 1 1.41-1.41zM10 16a6 6 0 1 0 0-12 6 6 0 0 0 0 12z" />
                    </svg>
                </button>
            </div>
        </form>

    </div>
    <div class="grid lg:grid-cols-3 grid-cols-1 gap-3 w-full h-full mx-auto">
        <div class="col-span-1">
                <a href="@Url.Action("Index", "Ingredient")">
                <div class="my-div relative hover-container overflow-hidden shadow-lg h-48">
                    <img src="~/FileUpload/images/home/ingredient.jpg" alt="Product"
                         class="hover-image w-full h-full object-cover transition-transform duration-500">

                    <!-- Decorative Lines -->
                    <div class="decor-line line-horizontal bg-white"></div>
                    <div class="decor-line line-vertical bg-white"></div>

                    <!-- Product Info -->
                    <div class="hover-info absolute bottom-10 left-10  p-1 text-white">
                        <h2 class="text-sm bg-black bg-opacity-0 font-bold text-slide text-left">TÌM KIẾM</h2>
                        <p class="text-lg bg-black bg-opacity-0 font-bold text-slide text-right">
                            Theo Nguyên Liệu
                        </p>
                    </div>
                </div>
            </a>
        </div>
        <div class="col-span-1 flex flex-col gap-3">
                <a href="@Url.Action("Index", "Course")">
                <div class="relative hover-container overflow-hidden shadow-lg h-48">
                    <img src="~/FileUpload/images/home/course.jpg" alt="Product"
                         class="hover-image w-full h-full object-cover transition-transform duration-500">

                    <!-- Decorative Lines -->
                    <div class="decor-line line-horizontal bg-white"></div>
                    <div class="decor-line line-vertical bg-white"></div>

                    <!-- Product Info -->
                    <div class="hover-info absolute bottom-10 left-10  p-1 text-white">
                        <h2 class="text-sm bg-black bg-opacity-0 font-bold text-slide text-left">TÌM KIẾM</h2>
                        <p class="text-lg bg-black bg-opacity-0 font-bold text-slide text-right">Theo Thực Đơn</p>
                    </div>
                </div>
            </a>

            <a href="#">
                <div class="relative hover-container overflow-hidden shadow-lg h-48">
                    <img src="~/FileUpload/images/home/tips.jpg" alt="Product"
                         class="hover-image w-full h-full object-cover transition-transform duration-500">

                    <!-- Decorative Lines -->
                    <div class="decor-line line-horizontal bg-white"></div>
                    <div class="decor-line line-vertical bg-white"></div>

                    <!-- Product Info -->
                    <div class="hover-info absolute bottom-10 left-10  p-1 text-white">
                        <h2 class="text-sm bg-black bg-opacity-0 font-bold text-slide text-left">TÌM KIẾM</h2>
                        <p class="text-lg bg-black bg-opacity-0 font-bold text-slide text-right">Mẹo Nấu Ăn</p>
                    </div>
                </div>
            </a>

        </div>

        <div class="col-span-1 flex flex-col gap-3">
                <a href="@Url.Action("Index", "Recipe")">
                <div class="relative hover-container overflow-hidden shadow-lg h-48">
                    <img src="~/FileUpload/images/home/food.jpg" alt="Product"
                         class="hover-image w-full h-full object-cover transition-transform duration-500">

                    <!-- Decorative Lines -->
                    <div class="decor-line line-horizontal bg-white"></div>
                    <div class="decor-line line-vertical bg-white"></div>

                    <!-- Product Info -->
                    <div class="hover-info absolute bottom-10 left-10  p-1 text-white">
                        <h2 class="text-sm bg-black bg-opacity-0 font-bold text-slide text-left">TÌM KIẾM</h2>
                        <p class="text-lg bg-black bg-opacity-0 font-bold text-slide text-right">Món Ăn</p>
                    </div>
                </div>
            </a>

            <a href="#">
                <div class="relative hover-container overflow-hidden shadow-lg h-48">
                    <img src="~/FileUpload/images/home/chef.jpg" alt="Product"
                         class="hover-image w-full h-full object-cover transition-transform duration-500">

                    <!-- Decorative Lines -->
                    <div class="decor-line line-horizontal bg-white"></div>
                    <div class="decor-line line-vertical bg-white"></div>

                    <!-- Product Info -->
                    <div class="hover-info absolute bottom-10 left-10  p-1 text-white">
                        <h2 class="text-sm bg-black bg-opacity-0 font-bold text-slide text-left">TÌM KIẾM</h2>
                        <p class="text-lg bg-black bg-opacity-0 font-bold text-slide text-right">Theo Tác Giả</p>
                    </div>
                </div>
            </a>

        </div>

    </div>


</div>

<!-- News -->
@*
<div class="mt-20 w-full flex flex-1 flex-col justify-center bg-white p-5 mb-5">
    <h1 class="text-xl font-regular mx-auto text-br mt-15">News</h1>
    <h1 class="text-3xl font-regular mx-auto text-bl mb-3">Tin tức và cập nhật</h1>
    <div class="w-full grid grid-cols-1 md:grid-cols-2 gap-6">
        <!-- Bài viết 1 -->
        <div class="bg-white col-span-1 rounded-lg overflow-hidden shadow-lg">
            <img src="~/FileUpload/images/home/chef.jpg" alt="Tây Ban Nha" class="w-full h-64 object-cover">
            <div class="p-5">
                <div class="flex">
                    <p class="text-sm text-gray-500">BY COOKINRECIPE</p>
                    <p class="ml-auto text-sm text-gray-500">30/09/2025 - 06:30AM</p>
                </div>

                <h2 class="cursor-pointer text-xl font-medium text-gray-800">
                    12 món ăn ở Huế nhất định phải thử một
                    lần
                </h2>
                <a href="#" class="text-yellow-700 font-medium mt-2 inline-block">READ MORE →</a>
            </div>
        </div>
    </div>
</div>
*@
<!-- Contact -->
<div class="mt-20 relative flex items-top justify-center min-h-screen sm:items-down sm:pt-0"
     style="margin-top: 50px;">
    <div class="max-w-6xl flex flex-1 flex-col justify-center mx-auto sm:px-6 lg:px-8">
        <h1 class="text-xl font-regular mx-auto text-br mt-15">Đánh giá</h1>
        <h1 class="text-3xl font-regular mx-auto text-bl mb-3">Gửi đánh giá của bạn về CookinRecipe</h1>
        <div class="mt-8 overflow-hidden">
            <div class="grid grid-cols-1 md:grid-cols-2">
                <div class="p-6 mr-20 dark:bg-blue-500 sm:rounded-lg">
                    <p class=" ...,text-normal text-sm sm:text-lg font-medium text-white-500 dark:text-white-500 mt-2">
                        Mỗi đánh giá phản hồi của bạn sẽ giúp CookinRecipe ngày càng hoàn thiện hơn. Đừng ngại gửi
                        đánh giá ngay cho chúng tôi tại các địa chỉ sau:
                    </p>


                    <div class="flex items-center mt-8 text-gray-600 dark:text-gray-400">
                        <svg fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"
                             stroke-width="1.5" viewBox="0 0 24 24" class="w-8 h-8 text-gray-500">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                                  d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                                  d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
                        </svg>
                        <div class="ml-4 text-md tracking-wide font-medium w-40">
                            Vietnam
                        </div>
                    </div>

                    <div class="flex items-center mt-4 text-gray-600 dark:text-gray-400">
                        <svg fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"
                             stroke-width="1.5" viewBox="0 0 24 24" class="w-8 h-8 text-gray-500">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                                  d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
                        </svg>
                        <div class="ml-4 text-md tracking-wide font-medium w-40">
                            +84123456789
                        </div>
                    </div>

                    <div class="flex items-center mt-2 text-gray-600 dark:text-gray-400">
                        <svg fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"
                             stroke-width="1.5" viewBox="0 0 24 24" class="w-8 h-8 text-gray-500">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                                  d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                        </svg>
                        <div class="ml-4 text-md tracking-wide font-medium w-40">
                            trangdo3009@gmail.com
                        </div>
                    </div>
                </div>

                <form asp-controller="Home" asp-action="SendFeedback" method="post" class="p-6 flex bg-gradient-to-r from-blue-600 to-purple-600 flex-col justify-center" id="feedbackForm">
                    <div class="flex flex-col">
                        <label for="name" class="text-white font-regular text-md">Họ Tên</label>
                        <input type="text" name="name" id="name" placeholder="Nhập họ tên của bạn"
                               class="w-full mt-2 py-3 px-3 rounded-lg font-regular border border-white focus:outline-none" />
                    </div>
                    <div class="flex flex-col mt-2">
                        <label for="email" class="text-white font-regular text-md">Email</label>
                        <input type="email" name="email" id="email" placeholder="Nhập email của bạn"
                               class="w-full mt-2 py-3 px-3 rounded-lg font-regular border border-white focus:outline-none" />
                    </div>
                    <div class="flex flex-col mt-2">
                        <label for="note" class="text-white font-regular text-md">Đánh giá</label>
                        <textarea name="note" id="note" placeholder="Nhập ý kiến của bạn"
                                  class="w-full mt-2 py-3 px-3 rounded-lg font-regular border border-white focus:outline-none"></textarea>
                    </div>
                    <button type="submit"
                            class="w-full bg-white mt-5 hover:bg-gray-400 text-black hover:text-white font-bold py-3 px-6 rounded-lg transition ease-in-out duration-300">
                        Gửi đánh giá
                    </button>
                </form>

            </div>
        </div>
    </div>
</div>

    <!-- 💬 AI Chatbox -->
    <div id="ai-chatbox" style="position: fixed; bottom: 20px; right: 20px; width: 320px; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; z-index: 9999; box-shadow: 0 4px 8px rgb(0 0 0 / 0.1); border-radius: 10px; overflow: hidden;">
        <div id="chat-toggle" style="
		background: linear-gradient(90deg, #2563EB, #7C3AED); /* blue-600 to purple-600 */
		color: white;
		padding: 12px 15px;
		font-weight: 600;
		font-size: 16px;
		border-radius: 10px 10px 0 0;
		cursor: pointer;
		user-select: none;
		text-align: center;
		box-shadow: 0 2px 6px rgb(0 0 0 / 0.2);
    " class="font-sans">
            💬 Hỏi AI nè!
        </div>
        <div id="chat-body" style="
		display: none;
		background: #fff;
		border: 1px solid #ddd;
		border-top: none;
		max-height: 400px;
		overflow-y: auto;
		padding: 12px 15px;
		font-size: 14px;
		color: #111;
    ">
            <div id="chat-messages" style="margin-bottom: 10px;"></div>
            <input type="text" id="chat-input" placeholder="Nhập câu hỏi..." style="
			width: 100%;
			padding: 10px;
			border: 1px solid #ccc;
			border-radius: 8px;
			font-size: 14px;
			box-sizing: border-box;
        "
            class="font-sans"/>
        </div>
    </div>
    @{
        var userName = "Bạn";
    }
    <script>
        const username = "Bạn";

        $('#chat-toggle').click(function () {
            $('#chat-body').toggle();
        });

        $('#chat-input').keypress(function (e) {
            if (e.which === 13) {
                const message = $(this).val().trim();
                if (!message) return;

                $('#chat-messages').append(`<div class="font-sans"><b>${username}:</b> ${escapeHtml(message)}</div>`);
                $(this).val('');

                fetch('/AI/Chat', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ message })
                })
                    .then(res => res.json())
                    .then(data => {
                        $('#chat-messages').append(`<div style="margin-top:5px;" class="font-sans"><b>CookinRecipe AI:</b> ${escapeHtml(data.reply)}</div>`);
                        $('#chat-body').scrollTop($('#chat-body')[0].scrollHeight);
                    })
                    .catch(() => {
                        $('#chat-messages').append(`<div style="margin-top:5px; font-style: italic; color: #888;" class="font-sans">Bạn hãy đăng nhập để chat với CookinRecipe AI nhé!</div>`);
                    });
            }
        });

        function escapeHtml(text) {
            return text.replace(/[&<>"']/g, function (m) {
                return { '&': '&amp;', '<': '&lt;', '>': '&gt;', '"': '&quot;', "'": '&#39;' }[m];
            });
        }
    </script>

    <style>
        #chat-body::-webkit-scrollbar {
            width: 6px;
        }

        #chat-body::-webkit-scrollbar-track {
            background: #f0f0f0;
            border-radius: 3px;
        }

        #chat-body::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, #2563EB, #7C3AED);
            border-radius: 3px;
        }

            #chat-body::-webkit-scrollbar-thumb:hover {
                background: linear-gradient(180deg, #1e40af, #5b21b6);
            }

        /* Firefox scrollbar */
        #chat-body {
            scrollbar-width: thin;
            scrollbar-color: #2563EB #f0f0f0;
        }
    </style>
<script>
    $(document).ready(function () {
        $("#feedbackForm").submit(function (e) {
            e.preventDefault();

            const name = $("#name").val();
            const email = $("#email").val();
            const note = $("#note").val();

            $.ajax({
                type: "POST",
                url: "@Url.Action("SendFeedback", "Home")",
                data: { name, email, note },
                success: function (response) {
                    if (response.success) {
                        ThongBao(response.message, "success");
                        $("form")[0].reset();
                    } else {
                        ThongBao(response.message, "warning");
                    }
                },
                error: function () {
                    ThongBao("Có lỗi khi kết nối server", "error");
                }
            });
        });
    });
</script>

<script src="/js/saveFavRate.js"></script>
<section class="bg-gradient-to-r font-sans from-blue-600 to-purple-600 mt-20">
    <div class="max-w-screen-xl px-4 py-12 mx-auto space-y-8 overflow-hidden sm:px-6 lg:px-8">
        <div class="flex justify-center mt-8 space-x-6">
            <a href="https://www.facebook.com/annyeongannie/" class="text-gray-50 hover:text-white">
                <span class="sr-only">Facebook</span>
                <svg class="w-6 h-6" aria-hidden="true" fill="currentColor" viewBox="0 0 24 24">
                    <path fill-rule="evenodd"
                          d="M22 12c0-5.523-4.477-10-10-10S2 6.477 2 12c0 4.991 3.657 9.128 8.438 9.878v-6.987h-2.54V12h2.54V9.797c0-2.506 1.492-3.89 3.777-3.89 1.094 0 2.238.195 2.238.195v2.46h-1.26c-1.243 0-1.63.771-1.63 1.562V12h2.773l-.443 2.89h-2.33v6.988C18.343 21.128 22 16.991 22 12z"
                          clip-rule="evenodd"></path>
                </svg>
            </a>
            <a href="https://x.com/annyeongannie_" class="text-gray-50 hover:text-white">
                <span class="sr-only">Twitter</span>
                <svg class="w-6 h-6" aria-hidden="true" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M8.29 20.251c7.547 0 11.675-6.253 11.675-11.675 0-.178 0-.355-.012-.53A8.348 8.348 0 0022 5.92a8.19 8.19 0 01-2.357.646 4.118 4.118 0 001.804-2.27 8.224 8.224 0 01-2.605.996 4.107 4.107 0 00-6.993 3.743 11.65 11.65 0 01-8.457-4.287 4.106 4.106 0 001.27 5.477A4.072 4.072 0 012.8 9.713v.052a4.105 4.105 0 003.292 4.022 4.095 4.095 0 01-1.853.07 4.108 4.108 0 003.834 2.85A8.233 8.233 0 012 18.407a11.616 11.616 0 006.29 1.84">
                    </path>
                </svg>
            </a>
            <a href="https://github.com/AnnieYZL" class="text-gray-50 hover:text-white">
                <span class="sr-only">GitHub</span>
                <svg class="w-6 h-6" aria-hidden="true" fill="currentColor" viewBox="0 0 24 24">
                    <path fill-rule="evenodd"
                          d="M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z"
                          clip-rule="evenodd"></path>
                </svg>
            </a>

        </div>
        <p class="mt-8 text-base leading-6 text-center text-gray-50">
            © 2025 Cookin'Recipe, Inc. All rights reserved.
        </p>
    </div>
</section>
</body>
